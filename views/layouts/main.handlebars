<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="icon" href="../../public/images/logo.svg" alt="TB letters in a circle"/>
    <title>Tech Blog</title>
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <header class="header"> 
        <h1>Tech Blog</h1>  
    
        <nav> 
            <ul>
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/dashboard">Dashboard</a>
                </li>
                {{#if logged_in}}
                <li>
                    <a id="logout">Logout</a>
                </li>
                
                {{else}}
                <li>
                    <a href="/login" >Login</a>
                </li>                
                {{/if}}

            </ul>
        </nav>
    </header>

    <main>
        {{{body}}}
    </main>
</body>
{{#if logged_in}}
    <script >
        //logout event handler
        const logout=  async () => {

            //send POST request for logout
            const response = await fetch('/api/users/logout', {
                method: 'POST',
                headers: { 'Content-Type': 'application/javascript' },
            });

            // if sucessful redirect user to home
            if (response.ok) {
                document.location.replace('/');
            } else {
                alert(response.statusText);
            }
        };
        document
        .querySelector('#logout')
        .addEventListener('click', logout);
    </script>
{{/if}}
</html>
